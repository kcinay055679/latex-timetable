\ExplSyntaxOn{}
\cs_new_eq:NN \Repeat\prg_replicate:nn

\newcommand{\aDay}[1]{
  \int_step_inline:nn {\expandafter\blockAmountPerIpaDay} {& \makecell{##1}}
}
\ExplSyntaxOff{}

\storeareas\zeitplan
\KOMAoptions{paper=a2, paper=landscape, DIV=current}
\areaset
  {\dimexpr\the\paperwidth -1cm\relax}% calculate requiered \textwidth
  {\dimexpr\the\paperheight -5cm\relax}% calculate requiered \textheight
\recalctypearea


\newcommand{\newcouterinit}[2][0]{\newcounter{#2}\setcounter{#2}{#1}}



\def\useone#1{#1}




\newcommand{\ipaDayHeader}[1]{
  &\multicolumn{\blockAmountPerIpaDay}{|c|}{#1}
}
\newcommand{\holidyDayHeader}[1]{
  &
  #1
  \insertRestDaySpace 
}


\newcommand{\task}[3]{
  #1
  \timeslot{currentPlannedHours}{#2}
  \addtocounter{sprintPlannedHours}{#2}
  \\
  \timeslot{currentDoneHours}{#3}
  \addtocounter{sprintDoneHours}{#3}
  \\\hline
}

\newcommand{\sprint}[2]{
 \timeslot{#2}{\arabic{#1}}
}

\newcommand{\StartSprint}{
  \setcounter{sprintPlannedHoursBase}{\arabic{currentPlannedHours}}
  \setcounter{sprintDoneHoursBase}{\arabic{currentDoneHours}}
  \setcounter{sprintPlannedHours}{0}
  \setcounter{sprintDoneHours}{0}
}

\newcommand{\EndSprint}[1]{
  #1
  \sprint{sprintPlannedHoursBase}{sprintPlannedHours}
  \\
  \sprint{sprintDoneHoursBase}{sprintDoneHours}
  \\\hline
}

\newcommand\coloredCell[3]{\multicolumn{#2}{Sc}{\cellcolor[HTML]{\getColor{#1}}#3}}
\newcommand\emptycells[1]{\Repeat{#1}{& \makecell{}}}


