\ExplSyntaxOn{}
\cs_new_eq:NN \Repeat\prg_replicate:nn
\ExplSyntaxOff{}

\storeareas\zeitplan
\KOMAoptions{paper=a3, paper=landscape, DIV=current}
% \areaset
%   {\dimexpr\the\paperwidth-1cm\relax}% calculate requiered \textwidth
%   {\dimexpr\the\paperheight\relax}% calculate requiered \textheight
% \recalctypearea


\newcommand{\newcouterinit}[2][0]{\newcounter{#2}\setcounter{#2}{#1}}





\newcommand{\aDay}[1]{
  % \blockAmountPerIpaDay -1
  \Repeat{15}{\makecell{\blockSize}&}
  \makecell{\blockSize}&
}

\newcommand{\ipaDayHeader}[1]{
  
\multicolumn{\blockAmountPerIpaDay}{c}{
  % #1
  \begin{tabular}{*{16}{l|}}
    % \multicolumn{14}{c}{#1}
    \aDay{}
  \end{tabular}
}
}


\newcommand{\timeslot}[3]{
  \ifnum\number#1>0
    \emptycells{\number#1} 
  \fi
  % \isWorkday:n{0}
  % \isWorkday{1}
  
  % \isWorkday:n{3}
  % #2(\isWorkday:n{#1})
  \Greencells{#2}{} &
  \emptycells{#3} 
}

\newcommand{\task}[3]{
  \\\hhline{*{\headerColsAmount}{-}}
  #1
  &

  \timeslot{\number\thecurrentPlannedHours}{#2}{\numexpr\number\blockAmount-\number\thecurrentPlannedHours- (#2) -1\relax}
  \\
  \emptycells{} &
  \timeslot{\number\thecurrentDoneHours}{#3}{\numexpr\number\blockAmount-\number\thecurrentDoneHours- (#3) -1\relax}

  \addtocounter{currentPlannedHours}{\number#2}
  \addtocounter{currentDoneHours}{\number#3}
}


\newcommand\Greencells[2]{\multicolumn{#1}{Sc}{\cellcolor[HTML]{009901}#2}}
\newcommand\Lightbluecells[2]{\multicolumn{#1}{Sc}{\cellcolor[HTML]{34CDF9}#2}}
\newcommand\emptycells[1]{\Repeat{#1}{\makecell{} &}}