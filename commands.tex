\ExplSyntaxOn{}
\cs_new_eq:NN \Repeat\prg_replicate:nn
\ExplSyntaxOff{}

\storeareas\zeitplan
\KOMAoptions{paper=a3, paper=landscape, DIV=current}
% \areaset
%   {\dimexpr\the\paperwidth-1cm\relax}% calculate requiered \textwidth
%   {\dimexpr\the\paperheight\relax}% calculate requiered \textheight
% \recalctypearea


\newcommand{\newcouterinit}[2][0]{\newcounter{#2}\setcounter{#2}{#1}}





\newcommand{\aDay}[1]{
  \Repeat{\blockAmountPerIpaDay}{& \makecell{\blockSize}}
}

\newcommand{\ipaDayHeader}[1]{
  &\multicolumn{\blockAmountPerIpaDay}{|c|}{#1}
}
\newcommand{\holidyDayHeader}{
  & Frei
}

\newcommand{\whitespace}[1]{
  & \addtocounter{#1}{1}
}


\newcommand{\smartWhiteSpace}[1]{
  % \arabic{#1}
  \isWorkday{\arabic{#1}}{\whitespace{#1}\smartWhiteSpace{#1}}
}



\newcommand{\timeslot}[2]{
  \ifnum\arabic{#1}>0
    \emptycells{\arabic{#1}}
  \fi
  % \smartWhiteSpace{#1}
  
  \Greencells{#2}{#2 (\isWorkday{\arabic{#1}}) (\arabic{#1})} &
  \emptycells{\numexpr\number\blockAmount-\arabic{#1} - (#2) -1\relax} 

  \addtocounter{#1}{\number#2}
  
}

\newcommand{\task}[3]{
  #1
  &\timeslot{currentPlannedHours}{#2}
  \\
  &\timeslot{currentDoneHours}{#3}
  \\\hline
}


\newcommand\Greencells[2]{\multicolumn{#1}{Sc}{\cellcolor[HTML]{009901}#2}}
\newcommand\Lightbluecells[2]{\multicolumn{#1}{Sc}{\cellcolor[HTML]{34CDF9}#2}}
\newcommand\emptycells[1]{\Repeat{#1}{\makecell{} &}}

\newcouterinit[0]{ipaDays}
\newcouterinit[0]{restDays}
\newcommand{\addIpaDay}{\addtocounter{ipaDays}{1}}
\newcommand{\addRestDay}{\addtocounter{restDays}{1}}

